<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†åå°èº«ä»½éªŒè¯æµ‹è¯•</title>
    
    <!-- å¼•ç”¨ä¸»ç«™æ ·å¼ -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 2rem;
            background: #f9fafb;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .test-section {
            margin-bottom: 2rem;
            padding: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        
        .test-section h3 {
            margin: 0 0 1rem 0;
            color: #374151;
        }
        
        .test-button {
            background: #7c3aed;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .test-button:hover {
            background: #6d28d9;
        }
        
        .test-result {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 6px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        
        .success {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #166534;
        }
        
        .error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
        }
        
        .info {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            color: #1d4ed8;
        }
        
        .admin-link {
            display: inline-block;
            background: #059669;
            color: white;
            padding: 1rem 2rem;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            margin-top: 1rem;
        }
        
        .admin-link:hover {
            background: #047857;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }
        
        .status-success {
            background: #10b981;
        }
        
        .status-error {
            background: #ef4444;
        }
        
        .status-warning {
            background: #f59e0b;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ” ç®¡ç†åå°èº«ä»½éªŒè¯æµ‹è¯•</h1>
        <p>æµ‹è¯•ç®¡ç†å‘˜ç™»å½•ã€è§’è‰²éªŒè¯å’Œè®¿é—®æ§åˆ¶åŠŸèƒ½</p>
        
        <!-- é…ç½®æ£€æŸ¥ -->
        <div class="test-section">
            <h3>1. é…ç½®æ£€æŸ¥</h3>
            <button class="test-button" onclick="checkConfig()">æ£€æŸ¥é…ç½®</button>
            <div id="config-result" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- æ•°æ®åº“è¿æ¥æµ‹è¯• -->
        <div class="test-section">
            <h3>2. æ•°æ®åº“è¿æ¥æµ‹è¯•</h3>
            <button class="test-button" onclick="testDatabase()">æµ‹è¯•æ•°æ®åº“è¿æ¥</button>
            <button class="test-button" onclick="checkAdminFunction()">æ£€æŸ¥ç®¡ç†å‘˜å‡½æ•°</button>
            <button class="test-button" onclick="testTableStructure()">æµ‹è¯•è¡¨ç»“æ„å…³ç³»</button>
            <button class="test-button" onclick="checkUserSync()">æ£€æŸ¥ç”¨æˆ·åŒæ­¥çŠ¶æ€</button>
            <div id="database-result" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- èº«ä»½éªŒè¯æµ‹è¯• -->
        <div class="test-section">
            <h3>3. èº«ä»½éªŒè¯æµ‹è¯•</h3>
            <div style="margin-bottom: 1rem;">
                <input type="email" id="test-email" placeholder="æµ‹è¯•é‚®ç®±" style="padding: 0.5rem; margin-right: 0.5rem; border: 1px solid #d1d5db; border-radius: 4px;">
                <input type="password" id="test-password" placeholder="æµ‹è¯•å¯†ç " style="padding: 0.5rem; margin-right: 0.5rem; border: 1px solid #d1d5db; border-radius: 4px;">
            </div>
            <button class="test-button" onclick="testLogin()">æµ‹è¯•ç™»å½•</button>
            <button class="test-button" onclick="testRoleCheck()">æµ‹è¯•è§’è‰²éªŒè¯</button>
            <button class="test-button" onclick="testLogout()">æµ‹è¯•ç™»å‡º</button>
            <div id="auth-result" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- æƒé™æµ‹è¯• -->
        <div class="test-section">
            <h3>4. æƒé™æµ‹è¯•</h3>
            <button class="test-button" onclick="testPermissions()">æµ‹è¯•æƒé™æ£€æŸ¥</button>
            <button class="test-button" onclick="testAdminAccess()">æµ‹è¯•ç®¡ç†å‘˜è®¿é—®</button>
            <div id="permission-result" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- ä¼šè¯ç®¡ç†æµ‹è¯• -->
        <div class="test-section">
            <h3>5. ä¼šè¯ç®¡ç†æµ‹è¯•</h3>
            <button class="test-button" onclick="testSession()">æµ‹è¯•ä¼šè¯çŠ¶æ€</button>
            <button class="test-button" onclick="testSessionTimeout()">æµ‹è¯•ä¼šè¯è¶…æ—¶</button>
            <div id="session-result" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- ç³»ç»ŸçŠ¶æ€ -->
        <div class="test-section">
            <h3>6. ç³»ç»ŸçŠ¶æ€</h3>
            <div id="system-status">
                <p><span class="status-indicator status-warning"></span>ç­‰å¾…æµ‹è¯•...</p>
            </div>
            <button class="test-button" onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
        </div>
        
        <!-- ç®¡ç†åå°é“¾æ¥ -->
        <div style="text-align: center; margin-top: 2rem;">
            <a href="admin/" class="admin-link">
                <i class="fas fa-shield-alt"></i>
                è¿›å…¥ç®¡ç†åå°
            </a>
        </div>
    </div>
    
    <!-- å¼•ç”¨é…ç½®å’Œè®¤è¯è„šæœ¬ -->
    <script src="js/config.js"></script>
    
    <script>
        // æµ‹è¯•ç»“æœæ˜¾ç¤ºå‡½æ•°
        function showResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `test-result ${type}`;
            element.textContent = message;
        }
        
        // 1. æ£€æŸ¥é…ç½®
        function checkConfig() {
            try {
                const result = {
                    supabaseUrl: SUPABASE_CONFIG?.url ? 'âœ… å·²é…ç½®' : 'âŒ æœªé…ç½®',
                    supabaseKey: SUPABASE_CONFIG?.anonKey ? 'âœ… å·²é…ç½®' : 'âŒ æœªé…ç½®',
                    supabaseClient: typeof supabase !== 'undefined' ? 'âœ… å·²åˆå§‹åŒ–' : 'âŒ æœªåˆå§‹åŒ–',
                    appConfig: typeof APP_CONFIG !== 'undefined' ? 'âœ… å·²åŠ è½½' : 'âŒ æœªåŠ è½½'
                };
                
                const message = `é…ç½®æ£€æŸ¥ç»“æœ:
Supabase URL: ${result.supabaseUrl}
Supabase Key: ${result.supabaseKey}
Supabase Client: ${result.supabaseClient}
App Config: ${result.appConfig}`;
                
                const hasErrors = Object.values(result).some(v => v.includes('âŒ'));
                showResult('config-result', message, hasErrors ? 'error' : 'success');
                
            } catch (error) {
                showResult('config-result', `é…ç½®æ£€æŸ¥å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // 2. æµ‹è¯•æ•°æ®åº“è¿æ¥
        async function testDatabase() {
            try {
                showResult('database-result', 'æ­£åœ¨æµ‹è¯•æ•°æ®åº“è¿æ¥...', 'info');
                
                // æµ‹è¯•åŸºæœ¬è¿æ¥
                const { data, error } = await supabase
                    .from('users')
                    .select('count')
                    .limit(1);
                
                if (error) {
                    throw error;
                }
                
                showResult('database-result', 'âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ', 'success');
                
            } catch (error) {
                showResult('database-result', `âŒ æ•°æ®åº“è¿æ¥å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // æ£€æŸ¥ç®¡ç†å‘˜å‡½æ•°
        async function checkAdminFunction() {
            try {
                showResult('database-result', 'æ­£åœ¨æ£€æŸ¥ç®¡ç†å‘˜å‡½æ•°...', 'info');

                // æµ‹è¯• is_admin å‡½æ•°
                const { data, error } = await supabase
                    .rpc('is_admin', { user_id: '00000000-0000-0000-0000-000000000000' });

                if (error) {
                    throw error;
                }

                showResult('database-result', 'âœ… ç®¡ç†å‘˜å‡½æ•°æ£€æŸ¥æˆåŠŸ', 'success');

            } catch (error) {
                showResult('database-result', `âŒ ç®¡ç†å‘˜å‡½æ•°æ£€æŸ¥å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æµ‹è¯•è¡¨ç»“æ„å…³ç³»
        async function testTableStructure() {
            try {
                showResult('database-result', 'æ­£åœ¨æµ‹è¯•è¡¨ç»“æ„å…³ç³»...', 'info');

                // æµ‹è¯•å…³è”æŸ¥è¯¢ï¼šè·å–ç”¨æˆ·çš„å®Œæ•´ä¿¡æ¯
                const { data, error } = await supabase
                    .from('users')
                    .select(`
                        user_id,
                        username,
                        role,
                        status
                    `)
                    .limit(3);

                if (error) {
                    throw error;
                }

                if (data.length === 0) {
                    showResult('database-result', 'âš ï¸ public.users è¡¨ä¸­æ²¡æœ‰æ•°æ®', 'warning');
                    return;
                }

                // è·å–å¯¹åº”çš„è®¤è¯ä¿¡æ¯
                let message = 'è¡¨ç»“æ„å…³ç³»æµ‹è¯•ç»“æœ:\n\n';

                for (const user of data) {
                    // è·å–å¯¹åº”çš„ auth.users ä¿¡æ¯
                    const { data: authUser, error: authError } = await supabase.auth.admin.getUserById(user.user_id);

                    if (authError) {
                        message += `ç”¨æˆ· ${user.username}:\n`;
                        message += `  public.users: âœ… å­˜åœ¨\n`;
                        message += `  auth.users: âŒ æ— æ³•è·å– (${authError.message})\n\n`;
                    } else {
                        message += `ç”¨æˆ· ${user.username}:\n`;
                        message += `  public.users: âœ… å­˜åœ¨ (role: ${user.role})\n`;
                        message += `  auth.users: âœ… å­˜åœ¨ (email: ${authUser.user.email})\n`;
                        message += `  å…³è”æ­£ç¡®: âœ… user_id åŒ¹é…\n\n`;
                    }
                }

                showResult('database-result', message, 'success');

            } catch (error) {
                showResult('database-result', `âŒ è¡¨ç»“æ„å…³ç³»æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // 3. æµ‹è¯•ç™»å½•
        async function testLogin() {
            const email = document.getElementById('test-email').value;
            const password = document.getElementById('test-password').value;
            
            if (!email || !password) {
                showResult('auth-result', 'è¯·è¾“å…¥æµ‹è¯•é‚®ç®±å’Œå¯†ç ', 'error');
                return;
            }
            
            try {
                showResult('auth-result', 'æ­£åœ¨æµ‹è¯•ç™»å½•...', 'info');
                
                const { data, error } = await supabase.auth.signInWithPassword({
                    email,
                    password
                });
                
                if (error) {
                    throw error;
                }
                
                showResult('auth-result', `âœ… ç™»å½•æˆåŠŸ: ${data.user.email}`, 'success');
                
            } catch (error) {
                showResult('auth-result', `âŒ ç™»å½•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // æµ‹è¯•è§’è‰²éªŒè¯
        async function testRoleCheck() {
            try {
                showResult('auth-result', 'æ­£åœ¨æµ‹è¯•è§’è‰²éªŒè¯...', 'info');

                const { data: { user } } = await supabase.auth.getUser();

                if (!user) {
                    throw new Error('ç”¨æˆ·æœªç™»å½•');
                }

                // æ£€æŸ¥ç”¨æˆ·è§’è‰²ï¼ˆä» public.users è¡¨è·å–ï¼‰
                const { data, error } = await supabase
                    .from('users')
                    .select('username, role, status')
                    .eq('user_id', user.id)
                    .single();

                if (error) {
                    throw error;
                }

                const isAdmin = data.role === 'admin';
                const message = `è®¤è¯ä¿¡æ¯ï¼ˆauth.usersï¼‰:
é‚®ç®±: ${user.email}
æ³¨å†Œæ—¶é—´: ${new Date(user.created_at).toLocaleString()}

ç”¨æˆ·èµ„æ–™ï¼ˆpublic.usersï¼‰:
ç”¨æˆ·å: ${data.username}
è§’è‰²: ${data.role}
çŠ¶æ€: ${data.status}

ç®¡ç†å‘˜æƒé™: ${isAdmin ? 'âœ… æ˜¯' : 'âŒ å¦'}`;

                showResult('auth-result', message, isAdmin ? 'success' : 'error');

            } catch (error) {
                showResult('auth-result', `âŒ è§’è‰²éªŒè¯å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // æµ‹è¯•ç™»å‡º
        async function testLogout() {
            try {
                showResult('auth-result', 'æ­£åœ¨æµ‹è¯•ç™»å‡º...', 'info');
                
                const { error } = await supabase.auth.signOut();
                
                if (error) {
                    throw error;
                }
                
                showResult('auth-result', 'âœ… ç™»å‡ºæˆåŠŸ', 'success');
                
            } catch (error) {
                showResult('auth-result', `âŒ ç™»å‡ºå¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // 4. æµ‹è¯•æƒé™
        async function testPermissions() {
            try {
                showResult('permission-result', 'æ­£åœ¨æµ‹è¯•æƒé™æ£€æŸ¥...', 'info');
                
                const { data: { user } } = await supabase.auth.getUser();
                
                if (!user) {
                    throw new Error('ç”¨æˆ·æœªç™»å½•ï¼Œæ— æ³•æµ‹è¯•æƒé™');
                }
                
                // ä½¿ç”¨ RPC è°ƒç”¨æµ‹è¯•ç®¡ç†å‘˜æƒé™
                const { data, error } = await supabase
                    .rpc('is_admin', { user_id: user.id });
                
                if (error) {
                    throw error;
                }
                
                const message = `ç”¨æˆ·ID: ${user.id}\nç®¡ç†å‘˜æƒé™: ${data ? 'âœ… æ˜¯' : 'âŒ å¦'}`;
                showResult('permission-result', message, data ? 'success' : 'error');
                
            } catch (error) {
                showResult('permission-result', `âŒ æƒé™æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // æµ‹è¯•ç®¡ç†å‘˜è®¿é—®
        async function testAdminAccess() {
            try {
                showResult('permission-result', 'æ­£åœ¨æµ‹è¯•ç®¡ç†å‘˜è®¿é—®...', 'info');
                
                // å°è¯•è®¿é—®ç®¡ç†å‘˜æ—¥å¿—è¡¨
                const { data, error } = await supabase
                    .from('admin_logs')
                    .select('count')
                    .limit(1);
                
                if (error) {
                    throw error;
                }
                
                showResult('permission-result', 'âœ… ç®¡ç†å‘˜è®¿é—®æµ‹è¯•æˆåŠŸ', 'success');
                
            } catch (error) {
                showResult('permission-result', `âŒ ç®¡ç†å‘˜è®¿é—®æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // 5. æµ‹è¯•ä¼šè¯
        async function testSession() {
            try {
                showResult('session-result', 'æ­£åœ¨æµ‹è¯•ä¼šè¯çŠ¶æ€...', 'info');
                
                const { data: { session }, error } = await supabase.auth.getSession();
                
                if (error) {
                    throw error;
                }
                
                const message = session 
                    ? `âœ… ä¼šè¯æœ‰æ•ˆ\nç”¨æˆ·: ${session.user.email}\nè¿‡æœŸæ—¶é—´: ${new Date(session.expires_at * 1000).toLocaleString()}`
                    : 'âŒ æ— æœ‰æ•ˆä¼šè¯';
                
                showResult('session-result', message, session ? 'success' : 'error');
                
            } catch (error) {
                showResult('session-result', `âŒ ä¼šè¯æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        // æµ‹è¯•ä¼šè¯è¶…æ—¶
        function testSessionTimeout() {
            const timeout = 30 * 60 * 1000; // 30åˆ†é’Ÿ
            const message = `ä¼šè¯è¶…æ—¶è®¾ç½®: ${timeout / 1000 / 60} åˆ†é’Ÿ\nå½“å‰æ—¶é—´: ${new Date().toLocaleString()}`;
            showResult('session-result', message, 'info');
        }
        
        // æ£€æŸ¥ç”¨æˆ·åŒæ­¥çŠ¶æ€
        async function checkUserSync() {
            try {
                showResult('database-result', 'æ­£åœ¨æ£€æŸ¥ç”¨æˆ·åŒæ­¥çŠ¶æ€...', 'info');

                // æ£€æŸ¥å½“å‰ç™»å½•ç”¨æˆ·çŠ¶æ€
                const { data: { user } } = await supabase.auth.getUser();
                let currentUserStatus = 'æœªç™»å½•';
                let authUserExists = false;

                if (user) {
                    authUserExists = true;
                    const { data: userProfile, error: profileError } = await supabase
                        .from('users')
                        .select('username, role, status')
                        .eq('user_id', user.id)
                        .single();

                    if (profileError) {
                        if (profileError.code === 'PGRST116') {
                            currentUserStatus = `âŒ å½“å‰ç”¨æˆ· (${user.email}) åœ¨ public.users ä¸­ä¸å­˜åœ¨`;
                        } else {
                            currentUserStatus = `âŒ æŸ¥è¯¢ç”¨æˆ·èµ„æ–™å¤±è´¥: ${profileError.message}`;
                        }
                    } else {
                        currentUserStatus = `âœ… å½“å‰ç”¨æˆ· (${user.email}) å·²åŒæ­¥
  ç”¨æˆ·å: ${userProfile.username}
  è§’è‰²: ${userProfile.role}
  çŠ¶æ€: ${userProfile.status}`;
                    }
                }

                // æ£€æŸ¥ public.users æ•°é‡ - ä½¿ç”¨ä¸åŒçš„æ–¹æ³•é¿å… RLS é—®é¢˜
                const { data: publicUsers, error: publicError } = await supabase
                    .from('users')
                    .select('user_id');

                const publicCount = publicUsers ? publicUsers.length : 0;

                if (publicError) {
                    console.warn('æŸ¥è¯¢ public.users æ—¶é‡åˆ°æƒé™é—®é¢˜:', publicError.message);
                }

                // å°è¯•é€šè¿‡ RPC å‡½æ•°è·å–ç»Ÿè®¡ä¿¡æ¯ï¼ˆå¦‚æœå¯ç”¨ï¼‰
                let authCount = 'æ— æ³•è·å–';
                try {
                    const { data: stats, error: statsError } = await supabase
                        .from('admin_dashboard_stats')
                        .select('total_users')
                        .single();

                    if (!statsError && stats) {
                        // è¿™ä¸ªæ•°å­—æ¥è‡ª auth.users çš„ç»Ÿè®¡
                        authCount = 'é€šè¿‡ç»Ÿè®¡è§†å›¾è·å–';
                    }
                } catch (e) {
                    // ç»Ÿè®¡è§†å›¾å¯èƒ½ä¸å­˜åœ¨
                }

                // æ£€æŸ¥æ˜¯å¦æœ‰ç”¨æˆ·æ•°æ®
                const { data: sampleUsers, error: sampleError } = await supabase
                    .from('users')
                    .select('user_id, username, role')
                    .limit(5);

                let userSample = '';
                if (!sampleError && sampleUsers && sampleUsers.length > 0) {
                    userSample = '\n\nç”¨æˆ·æ ·æœ¬:';
                    sampleUsers.forEach(u => {
                        userSample += `\n- ${u.username} (${u.role})`;
                    });
                }

                const message = `ç”¨æˆ·åŒæ­¥çŠ¶æ€æ£€æŸ¥:

å½“å‰ç™»å½•çŠ¶æ€: ${authUserExists ? 'âœ… å·²ç™»å½•' : 'âŒ æœªç™»å½•'}
public.users è¡¨ç”¨æˆ·æ•°: ${publicCount || 0}${publicError ? ' (æŸ¥è¯¢å—é™ï¼Œå¯èƒ½å› ä¸ºRLSç­–ç•¥)' : ''}
å½“å‰ç”¨æˆ·åŒæ­¥çŠ¶æ€: ${currentUserStatus}

${userSample}

${!authUserExists ? '\nâš ï¸ è¯·å…ˆç™»å½•ä»¥è¿›è¡Œå®Œæ•´çš„åŒæ­¥æ£€æŸ¥' : ''}
${authUserExists && publicCount === 0 && !publicError ? '\nâš ï¸ æ£€æµ‹åˆ°ç”¨æˆ·åŒæ­¥é—®é¢˜ï¼å»ºè®®è¿è¡Œ fix_user_sync_issue.sql è„šæœ¬ä¿®å¤ã€‚' : ''}
${publicError ? '\nğŸ’¡ æç¤ºï¼šå¦‚æœSQLè¯Šæ–­è„šæœ¬æ˜¾ç¤ºæ•°æ®æ­£å¸¸ï¼Œåˆ™åŒæ­¥åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚' : ''}`;

                // å¦‚æœå½“å‰ç”¨æˆ·å·²ç™»å½•ä¸”èƒ½æŸ¥è¯¢åˆ°è‡ªå·±çš„èµ„æ–™ï¼Œå°±è®¤ä¸ºæ˜¯æˆåŠŸçš„
                const resultType = authUserExists && currentUserStatus.includes('âœ…') ? 'success' : 'warning';
                showResult('database-result', message, resultType);

            } catch (error) {
                showResult('database-result', `âŒ ç”¨æˆ·åŒæ­¥æ£€æŸ¥å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        async function runAllTests() {
            const statusElement = document.getElementById('system-status');
            statusElement.innerHTML = '<p><span class="status-indicator status-warning"></span>æ­£åœ¨è¿è¡Œæµ‹è¯•...</p>';

            try {
                checkConfig();
                await testDatabase();
                await checkAdminFunction();
                await checkUserSync();

                statusElement.innerHTML = '<p><span class="status-indicator status-success"></span>æ‰€æœ‰æµ‹è¯•å®Œæˆ</p>';

            } catch (error) {
                statusElement.innerHTML = '<p><span class="status-indicator status-error"></span>æµ‹è¯•è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯</p>';
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥é…ç½®
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(checkConfig, 500);
        });
    </script>
</body>
</html>
