<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡æ€æ¡†æ»šåŠ¨æµ‹è¯• - AIæç¤ºè¯å®åº“</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.6;
            background: var(--background-color);
        }
        .test-section {
            margin: 2rem 0;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-xl);
            background: var(--surface-color);
        }
        .test-result {
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 6px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success { background: #f0fdf4; border: 1px solid #22c55e; color: #166534; }
        .error { background: #fef2f2; border: 1px solid #ef4444; color: #dc2626; }
        .warning { background: #fffbeb; border: 1px solid #f59e0b; color: #d97706; }
        .info { background: #f0f9ff; border: 1px solid #3b82f6; color: #1d4ed8; }
        button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-lg);
            cursor: pointer;
            margin: var(--space-2);
            transition: var(--transition-fast);
        }
        button:hover { 
            background: var(--primary-hover);
            transform: translateY(-1px);
        }
        h2 { color: var(--text-primary); margin-top: 2rem; }
        h3 { color: var(--text-primary); }
        .scroll-test-content {
            height: 200px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: var(--space-3);
            background: var(--gray-50);
            margin: var(--space-3) 0;
        }
        .scroll-indicator {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
            background-size: 400% 400%;
            animation: gradientShift 3s ease infinite;
            color: white;
            padding: var(--space-2);
            margin: var(--space-1) 0;
            border-radius: var(--radius-md);
            text-align: center;
            font-weight: 600;
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/myspace.js"></script>
</head>
<body>
    <h1>ğŸ”„ æ¨¡æ€æ¡†æ»šåŠ¨æµ‹è¯•</h1>
    <p>æ­¤å·¥å…·ç”¨äºæµ‹è¯•åˆ›å»ºæç¤ºè¯æ¨¡æ€æ¡†çš„æ»šåŠ¨åŠŸèƒ½ä¿®å¤æ•ˆæœã€‚</p>

    <div class="test-section">
        <h3>ğŸ“‹ æ»šåŠ¨åŠŸèƒ½è¯´æ˜</h3>
        <div class="test-result info">
ä¿®å¤å†…å®¹ï¼š
1. æ¨¡æ€æ¡†é«˜åº¦é™åˆ¶ï¼šmax-height: 85vh
2. æ¨¡æ€æ¡†ä¸»ä½“æ»šåŠ¨ï¼šoverflow-y: auto
3. Flexboxå¸ƒå±€ï¼šç¡®ä¿æ­£ç¡®çš„é«˜åº¦è®¡ç®—
4. æ»šåŠ¨æ¡æ ·å¼ï¼šç¾åŒ–æ»šåŠ¨æ¡å¤–è§‚
5. è¡¨å•å¸ƒå±€ï¼šflexå¸ƒå±€ç¡®ä¿æ­£ç¡®æ˜¾ç¤º

æµ‹è¯•æ–¹æ³•ï¼š
- é¼ æ ‡æ»šè½®æ»šåŠ¨
- æ‹–æ‹½æ»šåŠ¨æ¡
- é”®ç›˜å¯¼èˆªï¼ˆTab/Shift+Tabï¼‰
- è§¦æ‘¸æ»šåŠ¨ï¼ˆç§»åŠ¨è®¾å¤‡ï¼‰
        </div>
    </div>

    <div class="test-section">
        <h3>ğŸ§ª æ¨¡æ€æ¡†æ»šåŠ¨æµ‹è¯•</h3>
        <button onclick="testCreatePromptModal()">æµ‹è¯•åˆ›å»ºæç¤ºè¯æ¨¡æ€æ¡†</button>
        <button onclick="testScrollBehavior()">æµ‹è¯•æ»šåŠ¨è¡Œä¸º</button>
        <div id="modal-test-results"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ“ æ»šåŠ¨åŒºåŸŸæ¼”ç¤º</h3>
        <p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ»šåŠ¨åŒºåŸŸæ¼”ç¤ºï¼Œæ¨¡æ‹Ÿæ¨¡æ€æ¡†å†…çš„æ»šåŠ¨æ•ˆæœï¼š</p>
        <div class="scroll-test-content">
            <div class="scroll-indicator">ğŸ” æ»šåŠ¨åŒºåŸŸå¼€å§‹</div>
            <div class="scroll-indicator">ğŸ“ è¡¨å•å­—æ®µ 1 - æ ‡é¢˜</div>
            <div class="scroll-indicator">ğŸ“ è¡¨å•å­—æ®µ 2 - æè¿°</div>
            <div class="scroll-indicator">ğŸ“ è¡¨å•å­—æ®µ 3 - åˆ†ç±»</div>
            <div class="scroll-indicator">ğŸ“ è¡¨å•å­—æ®µ 4 - æç¤ºè¯å†…å®¹</div>
            <div class="scroll-indicator">ğŸ“ è¡¨å•å­—æ®µ 5 - æ ‡ç­¾</div>
            <div class="scroll-indicator">ğŸ“ è¡¨å•å­—æ®µ 6 - ä½¿ç”¨æ¨¡å‹</div>
            <div class="scroll-indicator">ğŸ“ è¡¨å•å­—æ®µ 7 - å‚è€ƒè¾“å‡º</div>
            <div class="scroll-indicator">ğŸ”˜ æ“ä½œæŒ‰é’®åŒºåŸŸ</div>
            <div class="scroll-indicator">ğŸ”½ æ»šåŠ¨åŒºåŸŸç»“æŸ</div>
        </div>
        <p style="color: var(--text-secondary); font-size: 14px;">
            â˜ï¸ è¯·å°è¯•ç”¨é¼ æ ‡æ»šè½®ã€æ‹–æ‹½æ»šåŠ¨æ¡æˆ–é”®ç›˜æ–¹å‘é”®æ¥æ»šåŠ¨ä¸Šé¢çš„åŒºåŸŸ
        </p>
    </div>

    <div class="test-section">
        <h3>ğŸ”§ CSSæ ·å¼æ£€æŸ¥</h3>
        <button onclick="checkModalStyles()">æ£€æŸ¥æ¨¡æ€æ¡†æ ·å¼</button>
        <div id="style-check-results"></div>
    </div>

    <div class="test-section">
        <h3>ğŸ“± å“åº”å¼æµ‹è¯•</h3>
        <button onclick="testResponsiveModal()">æµ‹è¯•å“åº”å¼æ¨¡æ€æ¡†</button>
        <div id="responsive-test-results"></div>
    </div>

    <script>
        function addResult(containerId, type, title, content) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `<strong>${title}</strong>\n${content}`;
            container.appendChild(div);
        }

        function clearResults(containerId) {
            document.getElementById(containerId).innerHTML = '';
        }

        function testCreatePromptModal() {
            clearResults('modal-test-results');
            
            try {
                addResult('modal-test-results', 'info', 'æµ‹è¯•åˆ›å»ºæç¤ºè¯æ¨¡æ€æ¡†', 'æ­£åœ¨æ‰“å¼€æ¨¡æ€æ¡†...');

                // æ£€æŸ¥æ˜¯å¦æœ‰mySpaceManager
                if (!window.mySpaceManager) {
                    addResult('modal-test-results', 'error', 'æµ‹è¯•å¤±è´¥', 'mySpaceManageræœªåˆå§‹åŒ–');
                    return;
                }

                // åˆ›å»ºæ¨¡æ€æ¡†ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
                if (!document.getElementById('prompt-modal')) {
                    mySpaceManager.createPromptModal();
                    addResult('modal-test-results', 'success', 'æ¨¡æ€æ¡†åˆ›å»ºæˆåŠŸ', 'å·²åˆ›å»ºæç¤ºè¯æ¨¡æ€æ¡†');
                }

                // æ˜¾ç¤ºæ¨¡æ€æ¡†
                mySpaceManager.showCreatePromptModal();
                
                addResult('modal-test-results', 'success', 'æ¨¡æ€æ¡†æ˜¾ç¤ºæˆåŠŸ', `
æµ‹è¯•è¯´æ˜ï¼š
1. æ¨¡æ€æ¡†åº”è¯¥æ­£ç¡®æ˜¾ç¤º
2. å¯ä»¥ä½¿ç”¨é¼ æ ‡æ»šè½®æ»šåŠ¨è¡¨å•å†…å®¹
3. å¯ä»¥æ‹–æ‹½æ»šåŠ¨æ¡
4. Tabé”®å¯¼èˆªåº”è¯¥æ­£å¸¸å·¥ä½œ
5. è¡¨å•å­—æ®µåº”è¯¥å®Œå…¨å¯è§

è¯·åœ¨æ¨¡æ€æ¡†ä¸­æµ‹è¯•æ»šåŠ¨åŠŸèƒ½ï¼
                `);

                // æ·»åŠ æ»šåŠ¨æµ‹è¯•æç¤º
                setTimeout(() => {
                    const modal = document.getElementById('prompt-modal');
                    if (modal && modal.classList.contains('active')) {
                        addResult('modal-test-results', 'info', 'æ»šåŠ¨æµ‹è¯•æç¤º', `
æ¨¡æ€æ¡†å·²æ‰“å¼€ï¼Œè¯·æµ‹è¯•ï¼š
âœ… é¼ æ ‡æ»šè½®æ»šåŠ¨
âœ… æ‹–æ‹½æ»šåŠ¨æ¡
âœ… é”®ç›˜Tabå¯¼èˆª
âœ… æ‰€æœ‰è¡¨å•å­—æ®µå¯è§
                        `);
                    }
                }, 1000);

            } catch (error) {
                addResult('modal-test-results', 'error', 'æµ‹è¯•å¤±è´¥', error.message);
            }
        }

        function testScrollBehavior() {
            clearResults('modal-test-results');
            
            const modal = document.getElementById('prompt-modal');
            if (!modal || !modal.classList.contains('active')) {
                addResult('modal-test-results', 'warning', 'è¯·å…ˆæ‰“å¼€æ¨¡æ€æ¡†', 'è¯·å…ˆç‚¹å‡»"æµ‹è¯•åˆ›å»ºæç¤ºè¯æ¨¡æ€æ¡†"æŒ‰é’®');
                return;
            }

            const modalBody = modal.querySelector('.modal-body');
            if (!modalBody) {
                addResult('modal-test-results', 'error', 'æ¨¡æ€æ¡†ç»“æ„é”™è¯¯', 'æ‰¾ä¸åˆ°.modal-bodyå…ƒç´ ');
                return;
            }

            // æ£€æŸ¥æ»šåŠ¨å±æ€§
            const computedStyle = window.getComputedStyle(modalBody);
            const scrollHeight = modalBody.scrollHeight;
            const clientHeight = modalBody.clientHeight;
            const canScroll = scrollHeight > clientHeight;

            addResult('modal-test-results', 'info', 'æ»šåŠ¨è¡Œä¸ºæ£€æŸ¥', `
æ¨¡æ€æ¡†ä¸»ä½“æ ·å¼ï¼š
- overflow-y: ${computedStyle.overflowY}
- max-height: ${computedStyle.maxHeight}
- height: ${computedStyle.height}
- scroll-height: ${scrollHeight}px
- client-height: ${clientHeight}px
- å¯æ»šåŠ¨: ${canScroll ? 'æ˜¯' : 'å¦'}
            `);

            if (canScroll) {
                addResult('modal-test-results', 'success', 'æ»šåŠ¨åŠŸèƒ½æ­£å¸¸', 'æ¨¡æ€æ¡†å†…å®¹å¯ä»¥æ»šåŠ¨');
                
                // è‡ªåŠ¨æ»šåŠ¨æµ‹è¯•
                let scrollPosition = 0;
                const scrollTest = setInterval(() => {
                    scrollPosition += 50;
                    modalBody.scrollTop = scrollPosition;
                    
                    if (scrollPosition >= scrollHeight - clientHeight) {
                        clearInterval(scrollTest);
                        modalBody.scrollTop = 0; // æ»šå›é¡¶éƒ¨
                        addResult('modal-test-results', 'success', 'è‡ªåŠ¨æ»šåŠ¨æµ‹è¯•å®Œæˆ', 'å·²è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨å¹¶è¿”å›é¡¶éƒ¨');
                    }
                }, 100);
            } else {
                addResult('modal-test-results', 'warning', 'å†…å®¹æ— éœ€æ»šåŠ¨', 'å½“å‰å†…å®¹é«˜åº¦ä¸è¶…è¿‡å®¹å™¨é«˜åº¦');
            }
        }

        function checkModalStyles() {
            clearResults('style-check-results');
            
            // æ£€æŸ¥CSSæ ·å¼æ˜¯å¦æ­£ç¡®åŠ è½½
            const testElement = document.createElement('div');
            testElement.className = 'modal-content';
            testElement.id = 'test-modal-content';
            document.body.appendChild(testElement);
            
            const computedStyle = window.getComputedStyle(testElement);
            
            addResult('style-check-results', 'info', 'CSSæ ·å¼æ£€æŸ¥', `
.modal-content æ ·å¼ï¼š
- display: ${computedStyle.display}
- flex-direction: ${computedStyle.flexDirection}
- max-height: ${computedStyle.maxHeight}
- overflow: ${computedStyle.overflow}

.modal-body é¢„æœŸæ ·å¼ï¼š
- overflow-y: auto
- flex: 1
- min-height: 0
            `);
            
            // æ¸…ç†æµ‹è¯•å…ƒç´ 
            document.body.removeChild(testElement);
            
            // æ£€æŸ¥ç‰¹å®šçš„æ¨¡æ€æ¡†æ ·å¼
            const promptModalStyle = document.querySelector('#prompt-modal .modal-content');
            if (promptModalStyle) {
                const promptStyle = window.getComputedStyle(promptModalStyle);
                addResult('style-check-results', 'success', 'æç¤ºè¯æ¨¡æ€æ¡†æ ·å¼', `
#prompt-modal .modal-content:
- max-width: ${promptStyle.maxWidth}
- max-height: ${promptStyle.maxHeight}
                `);
            } else {
                addResult('style-check-results', 'warning', 'æç¤ºè¯æ¨¡æ€æ¡†æœªåˆ›å»º', 'è¯·å…ˆåˆ›å»ºæç¤ºè¯æ¨¡æ€æ¡†');
            }
        }

        function testResponsiveModal() {
            clearResults('responsive-test-results');
            
            addResult('responsive-test-results', 'info', 'å“åº”å¼æµ‹è¯•', 'æ­£åœ¨æµ‹è¯•ä¸åŒå±å¹•å°ºå¯¸...');
            
            // æ¨¡æ‹Ÿä¸åŒå±å¹•å°ºå¯¸
            const screenSizes = [
                { name: 'æ¡Œé¢ç«¯', width: 1200, height: 800 },
                { name: 'å¹³æ¿ç«¯', width: 768, height: 1024 },
                { name: 'æ‰‹æœºç«¯', width: 375, height: 667 }
            ];
            
            screenSizes.forEach(size => {
                // è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿæ£€æŸ¥ï¼Œå®é™…éœ€è¦æ”¹å˜çª—å£å¤§å°
                const modalMaxWidth = size.width < 768 ? '95%' : '600px';
                const modalMaxHeight = size.height < 600 ? '90vh' : '85vh';
                
                addResult('responsive-test-results', 'info', `${size.name} (${size.width}x${size.height})`, `
é¢„æœŸæ¨¡æ€æ¡†æ ·å¼ï¼š
- max-width: ${modalMaxWidth}
- max-height: ${modalMaxHeight}
- æ»šåŠ¨: ${size.height < 600 ? 'å¿…éœ€' : 'å¯é€‰'}
                `);
            });
            
            addResult('responsive-test-results', 'success', 'å“åº”å¼æ£€æŸ¥å®Œæˆ', 'è¯·æ‰‹åŠ¨è°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°æµ‹è¯•å“åº”å¼æ•ˆæœ');
        }

        // é¡µé¢åŠ è½½æ—¶çš„è¯´æ˜
        window.addEventListener('load', () => {
            setTimeout(() => {
                addResult('modal-test-results', 'info', 'æµ‹è¯•å‡†å¤‡å°±ç»ª', `
æ¨¡æ€æ¡†æ»šåŠ¨ä¿®å¤å·²å®Œæˆï¼ŒåŒ…å«ä»¥ä¸‹æ”¹è¿›ï¼š

ğŸ”§ æŠ€æœ¯ä¿®å¤ï¼š
- æ¨¡æ€æ¡†ä½¿ç”¨Flexboxå¸ƒå±€
- æ­£ç¡®çš„é«˜åº¦è®¡ç®—å’Œæ»šåŠ¨åŒºåŸŸ
- ä¼˜åŒ–çš„æ»šåŠ¨æ¡æ ·å¼
- å“åº”å¼é«˜åº¦è®¾ç½®

ğŸ§ª æµ‹è¯•æ–¹æ³•ï¼š
1. ç‚¹å‡»"æµ‹è¯•åˆ›å»ºæç¤ºè¯æ¨¡æ€æ¡†"æ‰“å¼€æ¨¡æ€æ¡†
2. åœ¨æ¨¡æ€æ¡†ä¸­å°è¯•é¼ æ ‡æ»šè½®æ»šåŠ¨
3. æ‹–æ‹½æ»šåŠ¨æ¡
4. ä½¿ç”¨Tabé”®å¯¼èˆª
5. æ£€æŸ¥æ‰€æœ‰è¡¨å•å­—æ®µæ˜¯å¦å¯è§

è¯·å¼€å§‹æµ‹è¯•ï¼
                `);
            }, 1000);
        });
    </script>
</body>
</html>
